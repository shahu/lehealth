define("example/lehealth/medicationinput",["jquery-mobile/1.4.4/jquery.mobile","./common"],function(a,b){var c=a("jquery-mobile/1.4.4/jquery.mobile"),d=a("./common"),e="/api/medicines",f="/api/medicinerecord";b.render=function(){c(document).bind("pageinit",function(){d.hideAddressBar();d.getCookieByKey("loginid"),d.getCookieByKey("tk");c.ajax({url:e,type:"GET",dataType:"json",async:!0,success:function(a){if(a.errorcode)d.showDialog("获取数据失败，请刷新界面","medicationinput");else{for(var b=a.result,e="",f=0;f<b.length;f++){e+='<optgroup label="'+b[f].catename+'">';for(var g=b[f].medicines,h=0;h<g.length;h++)e+='<option value="'+g[h].id+'">'+g[h].name+"</option>";e+="</optgroup>"}c("#medacine_name").empty(),c("#medacine_name").html(e),c("#medacine_name").selectmenu("refresh")}},error:function(){d.showDialog("获取数据失败，请刷新界面","medicationinput")}})})},b.bindEvent=function(){c(document).bind("pageinit",function(){c("#record_data").on("click",function(){var a=d.getCookieByKey("loginid"),b=d.getCookieByKey("tk"),e=c("#medacine_name").val(),g=c("#medacine_amount").val(),h=c("#medacine_time").val(),i=c("#medacine_count").val();c.ajax({url:f,type:"POST",dataType:"json",async:!0,data:{loginid:a,token:b,medicineid:e,amount:g,frequency:i,timing:h},success:function(a){if(a.errorcode){if(1===a.errorcode)return d.showDialog("请重新登录","medicationinput"),void setTimeout(function(){c.mobile.changePage("/lehealth/login.html","slide")},2e3);d.showDialog("提交数据失败，请重新提交","medicationinput")}else d.showDialog("提交成功","medicationinput"),setTimeout(function(){d.dismissDialog("medicationinput")},2e3)},error:function(){d.showDialog("提交数据失败，请重新提交","medicationinput")}})})})}}),define("example/lehealth/common",["jquery-mobile/1.4.4/jquery.mobile"],function(a,b){function c(a){var b,c={};c.href=a;for(var d in e)b=e[d].exec(a),c[d]=b[1],a=b[2],""===a&&(a="/"),"pathname"===d&&(c.pathname=b[1],c.search=b[2],c.hash=b[3]);return c}var d=a("jquery-mobile/1.4.4/jquery.mobile");b.hideAddressBar=function(){document.documentElement.scrollHeight<=document.documentElement.clientHeight&&(bodyTag=document.getElementsByTagName("body")[0],bodyTag.style.height=document.documentElement.clientWidth/screen.width*screen.height+"px"),setTimeout(function(){window.scrollTo(0,1)},0)};var e={protocol:/([^\/]+:)\/\/(.*)/i,host:/(^[^\:\/]+)((?:\/|:|$)?.*)/,port:/\:?([^\/]*)(\/?.*)/,pathname:/([^\?#]+)(\??[^#]*)(#?.*)/};b.getParams=function(a){var b=window.location.href,d=c(b).search,e={};if(d)for(var f=d.split("&"),g=0;g<f.length;g++){var h=f[g].split("=");2==h.length&&(e[h[0]]=decodeURIComponent(h[1]))}return e[a]},b.getCookieByKey=function(a){var b=document.cookie.split("; "),c={};for(var d in b){var e=b[d].split("=");2==e.length&&(c[e[0]]=decodeURIComponent(e[1]))}return c[a]},b.setCookie=function(a,b){var c=new Date;c.setTime(c.getTime()+31536e6),document.cookie=name+"="+escape(b)+";expires="+c.toGMTString()},b.showDialog=function(a,b){d("#"+b+" .dialog_text").html("<p>"+a+"</p>"),d("#"+b+" .dialog").popup(),d("#"+b+" .dialog").popup("open")},b.dismissDialog=function(a){d("#"+a+" .dialog").popup("close")}});
